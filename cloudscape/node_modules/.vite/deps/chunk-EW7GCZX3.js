import {
  Portal
} from "./chunk-TM5SCOBX.js";
import {
  PopoverBody,
  PopoverContainer,
  styles_css_default
} from "./chunk-5MQZRYSX.js";
import {
  dropdown_default,
  options_list_default,
  useDropdownContext,
  useOpenState,
  usePortalModeClasses
} from "./chunk-BVKXF4YZ.js";
import {
  InternalButton
} from "./chunk-WKOYGYGF.js";
import {
  useForwardFocus
} from "./chunk-VX6M7C7V.js";
import {
  useUniqueId
} from "./chunk-ZOQJCCJI.js";
import {
  InternalBox
} from "./chunk-HPKX24BK.js";
import {
  checkSafeUrl
} from "./chunk-JPGUN2BY.js";
import {
  fireCancelableEvent,
  isPlainLeftClick
} from "./chunk-CTALK4OT.js";
import {
  internal_default
} from "./chunk-CRWXG7GH.js";
import {
  useFunnel
} from "./chunk-7FZ3ZYD3.js";
import {
  useMobile
} from "./chunk-42KS5QK6.js";
import {
  KeyCode,
  __rest,
  clsx_m_default,
  getBaseProps,
  useReducedMotion
} from "./chunk-BATVD76T.js";
import {
  __toESM,
  require_react
} from "./chunk-C3URVCCN.js";

// node_modules/@cloudscape-design/components/button-dropdown/internal.js
var import_react11 = __toESM(require_react());

// node_modules/@cloudscape-design/components/button-dropdown/styles.css.js
import "/local/home/samilafo/final_epa_project/cloudscape_wrkshp/cloudscape-design-system-workshop/node_modules/@cloudscape-design/components/button-dropdown/styles.scoped.css";
var styles_css_default2 = {
  "button-dropdown": "awsui_button-dropdown_sne0l_14ox4_93",
  "items-list-container": "awsui_items-list-container_sne0l_14ox4_97",
  "awsui-motion-fade-in-0": "awsui_awsui-motion-fade-in-0_sne0l_14ox4_1",
  "rotate-up": "awsui_rotate-up_sne0l_14ox4_114",
  "rotate-down": "awsui_rotate-down_sne0l_14ox4_129",
  "header": "awsui_header_sne0l_14ox4_144",
  "title": "awsui_title_sne0l_14ox4_153",
  "description": "awsui_description_sne0l_14ox4_154"
};

// node_modules/@cloudscape-design/components/button-dropdown/items-list.js
var import_react9 = __toESM(require_react());

// node_modules/@cloudscape-design/components/button-dropdown/item-element/index.js
var import_react4 = __toESM(require_react());

// node_modules/@cloudscape-design/components/button-dropdown/utils/utils.js
var isItemGroup = (item) => item && item.items !== void 0;
var isLinkItem = (item) => item && item.href !== void 0;
var getItemTarget = (item) => item.external ? "_blank" : void 0;
function indexIncludes(source, target) {
  for (let index = 0; index < source.length; index++) {
    if (source[index] !== target[index]) {
      return false;
    }
  }
  return true;
}
function indexEquals(left, right) {
  if (left.length !== right.length) {
    return false;
  }
  for (let index = 0; index < left.length; index++) {
    if (left[index] !== right[index]) {
      return false;
    }
  }
  return true;
}

// node_modules/@cloudscape-design/components/button-dropdown/item-element/styles.css.js
import "/local/home/samilafo/final_epa_project/cloudscape_wrkshp/cloudscape-design-system-workshop/node_modules/@cloudscape-design/components/button-dropdown/item-element/styles.scoped.css";
var styles_css_default3 = {
  "item-element": "awsui_item-element_93a1u_afloc_93",
  "disabled": "awsui_disabled_93a1u_afloc_103",
  "last": "awsui_last_93a1u_afloc_110",
  "highlighted": "awsui_highlighted_93a1u_afloc_113",
  "variant-icon": "awsui_variant-icon_93a1u_afloc_117",
  "variant-normal": "awsui_variant-normal_93a1u_afloc_117",
  "variant-primary": "awsui_variant-primary_93a1u_afloc_117",
  "is-focused": "awsui_is-focused_93a1u_afloc_127",
  "variant-navigation": "awsui_variant-navigation_93a1u_afloc_131",
  "first": "awsui_first_93a1u_afloc_134",
  "has-category-header": "awsui_has-category-header_93a1u_afloc_134",
  "menu-item": "awsui_menu-item_93a1u_afloc_148",
  "icon": "awsui_icon_93a1u_afloc_166",
  "external-icon": "awsui_external-icon_93a1u_afloc_171"
};

// node_modules/@cloudscape-design/components/button-dropdown/tooltip.js
var import_react2 = __toESM(require_react());

// node_modules/@cloudscape-design/components/popover/arrow.js
var import_react = __toESM(require_react());
var Arrow = (props) => import_react.default.createElement(
  "div",
  { className: clsx_m_default(styles_css_default.arrow, props.position && styles_css_default[`arrow-position-${props.position}`]) },
  import_react.default.createElement("div", { className: styles_css_default["arrow-outer"] }),
  import_react.default.createElement("div", { className: styles_css_default["arrow-inner"] })
);
var arrow_default = import_react.default.memo(Arrow);

// node_modules/@cloudscape-design/components/button-dropdown/tooltip.js
var DEFAULT_OPEN_TIMEOUT_IN_MS = 120;
function Tooltip({ children, content, position = "right" }) {
  const ref = (0, import_react2.useRef)(null);
  const isReducedMotion = useReducedMotion(ref);
  const { open, triggerProps } = useTooltipOpen(isReducedMotion ? 0 : DEFAULT_OPEN_TIMEOUT_IN_MS);
  const portalClasses = usePortalModeClasses(ref);
  return import_react2.default.createElement(
    "span",
    Object.assign({ ref }, triggerProps),
    children,
    open && import_react2.default.createElement(
      Portal,
      null,
      import_react2.default.createElement(
        "span",
        { className: portalClasses },
        import_react2.default.createElement(
          PopoverContainer,
          { size: "small", fixedWidth: false, position, trackRef: ref, arrow: (position2) => import_react2.default.createElement(arrow_default, { position: position2 }), renderWithPortal: true, zIndex: 7e3 },
          import_react2.default.createElement(
            PopoverBody,
            { dismissButton: false, dismissAriaLabel: void 0, header: null, onDismiss: () => {
            }, overflowVisible: "both" },
            import_react2.default.createElement("span", { "data-testid": "button-dropdown-disabled-reason", role: "tooltip" }, content)
          )
        )
      )
    )
  );
}
function useTooltipOpen(timeout) {
  const handle = (0, import_react2.useRef)();
  const [isOpen, setIsOpen] = (0, import_react2.useState)(false);
  const close = () => {
    clearTimeout(handle.current);
    setIsOpen(false);
  };
  const open = () => setIsOpen(true);
  const openDelayed = () => {
    handle.current = setTimeout(open, timeout);
  };
  const onKeyDown = (e) => {
    if (isOpen && isEscape(e.key)) {
      e.preventDefault();
      e.stopPropagation();
      close();
    }
  };
  const onFocus = openDelayed;
  const onBlur = close;
  return {
    open: isOpen,
    triggerProps: {
      onBlur,
      onFocus,
      onKeyDown
    }
  };
}
var isEscape = (key) => key === "Escape" || key === "Esc";

// node_modules/@cloudscape-design/components/button-dropdown/utils/use-hidden-description.js
var import_react3 = __toESM(require_react());
function useHiddenDescription(description) {
  const id = useUniqueId();
  return {
    targetProps: {
      "aria-describedby": description ? id : void 0
    },
    descriptionEl: description ? import_react3.default.createElement("span", { id, hidden: true }, description) : null
  };
}

// node_modules/@cloudscape-design/components/button-dropdown/utils/menu-item.js
var getMenuItemProps = ({ disabled, parent, expanded }) => ({
  role: "menuitem",
  "aria-disabled": disabled ? "true" : void 0,
  "aria-haspopup": parent ? "true" : void 0,
  "aria-expanded": expanded ? "true" : parent ? "false" : void 0
});

// node_modules/@cloudscape-design/components/button-dropdown/item-element/index.js
var ItemElement = ({ item, disabled, onItemActivate, highlighted, highlightItem, first = false, last, hasCategoryHeader, isKeyboardHighlighted = false, variant = "normal" }) => {
  const isLink = isLinkItem(item);
  const onClick = (event) => {
    event.stopPropagation();
    if (!isLink) {
      event.preventDefault();
    }
    if (!disabled) {
      onItemActivate(item, event);
    }
  };
  const onHover = (event) => {
    event.preventDefault();
    highlightItem(item);
  };
  return import_react4.default.createElement(
    "li",
    { className: clsx_m_default(styles_css_default3["item-element"], styles_css_default3[`variant-${variant}`], {
      [styles_css_default3.highlighted]: highlighted,
      [styles_css_default3.disabled]: disabled,
      [styles_css_default3.first]: first,
      [styles_css_default3.last]: last,
      [styles_css_default3["has-category-header"]]: hasCategoryHeader,
      [styles_css_default3["is-focused"]]: isKeyboardHighlighted
    }), role: "presentation", "data-testid": item.id, "data-description": item.description, onClick, onMouseEnter: onHover, onTouchStart: onHover },
    import_react4.default.createElement(MenuItem, { item, disabled, highlighted })
  );
};
function MenuItem({ item, disabled, highlighted }) {
  const menuItemRef = (0, import_react4.useRef)(null);
  (0, import_react4.useEffect)(() => {
    if (highlighted && menuItemRef.current) {
      menuItemRef.current.focus();
    }
  }, [highlighted]);
  const isDisabledWithReason = disabled && item.disabledReason;
  const { targetProps, descriptionEl } = useHiddenDescription(item.disabledReason);
  const menuItemProps = Object.assign(Object.assign({
    className: styles_css_default3["menu-item"],
    lang: item.lang,
    ref: menuItemRef,
    tabIndex: highlighted ? 0 : -1
  }, getMenuItemProps({ disabled })), isDisabledWithReason ? targetProps : {});
  const menuItem = isLinkItem(item) ? import_react4.default.createElement(
    "a",
    Object.assign({}, menuItemProps, { href: !disabled ? item.href : void 0, target: getItemTarget(item), rel: item.external ? "noopener noreferrer" : void 0 }),
    import_react4.default.createElement(MenuItemContent, { item, disabled })
  ) : import_react4.default.createElement(
    "span",
    Object.assign({}, menuItemProps),
    import_react4.default.createElement(MenuItemContent, { item, disabled })
  );
  const { position } = useDropdownContext();
  const tooltipPosition = position === "bottom-left" || position === "top-left" ? "left" : "right";
  return isDisabledWithReason ? import_react4.default.createElement(
    Tooltip,
    { content: item.disabledReason, position: tooltipPosition },
    menuItem,
    descriptionEl
  ) : menuItem;
}
var MenuItemContent = ({ item, disabled }) => {
  const hasIcon = !!(item.iconName || item.iconUrl || item.iconSvg);
  const hasExternal = isLinkItem(item) && item.external;
  return import_react4.default.createElement(
    import_react4.default.Fragment,
    null,
    hasIcon && import_react4.default.createElement(MenuItemIcon, { name: item.iconName, url: item.iconUrl, svg: item.iconSvg, alt: item.iconAlt }),
    " ",
    item.text,
    " ",
    hasExternal && import_react4.default.createElement(ExternalIcon, { disabled, ariaLabel: item.externalIconAriaLabel })
  );
};
var MenuItemIcon = (props) => import_react4.default.createElement(
  "span",
  { className: styles_css_default3.icon },
  import_react4.default.createElement(internal_default, Object.assign({}, props))
);
var ExternalIcon = ({ disabled, ariaLabel }) => {
  const icon = import_react4.default.createElement(internal_default, { variant: disabled ? "disabled" : "normal", name: "external" });
  return import_react4.default.createElement("span", { className: styles_css_default3["external-icon"], role: ariaLabel ? "img" : void 0, "aria-label": ariaLabel }, icon);
};
var item_element_default = ItemElement;

// node_modules/@cloudscape-design/components/button-dropdown/category-elements/expandable-category-element.js
var import_react5 = __toESM(require_react());

// node_modules/@cloudscape-design/components/button-dropdown/category-elements/styles.css.js
import "/local/home/samilafo/final_epa_project/cloudscape_wrkshp/cloudscape-design-system-workshop/node_modules/@cloudscape-design/components/button-dropdown/category-elements/styles.scoped.css";
var styles_css_default4 = {
  "header": "awsui_header_16mm3_3iz83_93",
  "disabled": "awsui_disabled_16mm3_3iz83_108",
  "expandable-header": "awsui_expandable-header_16mm3_3iz83_112",
  "rolled-down": "awsui_rolled-down_16mm3_3iz83_123",
  "highlighted": "awsui_highlighted_16mm3_3iz83_126",
  "is-focused": "awsui_is-focused_16mm3_3iz83_139",
  "variant-navigation": "awsui_variant-navigation_16mm3_3iz83_143",
  "category": "awsui_category_16mm3_3iz83_155",
  "expandable": "awsui_expandable_16mm3_3iz83_112",
  "expand-icon": "awsui_expand-icon_16mm3_3iz83_176",
  "expand-icon-up": "awsui_expand-icon-up_16mm3_3iz83_183",
  "expand-icon-right": "awsui_expand-icon-right_16mm3_3iz83_186",
  "items-list-container": "awsui_items-list-container_16mm3_3iz83_200"
};

// node_modules/@cloudscape-design/components/button-dropdown/category-elements/expandable-category-element.js
var ExpandableCategoryElement = ({ item, onItemActivate, onGroupToggle, targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, disabled, expandToViewport, variant }) => {
  const highlighted = isHighlighted(item);
  const expanded = isExpanded(item);
  const isKeyboardHighlighted = isKeyboardHighlight(item);
  const triggerRef = import_react5.default.useRef(null);
  const ref = (0, import_react5.useRef)(null);
  (0, import_react5.useEffect)(() => {
    if (triggerRef.current && highlighted && !expanded) {
      triggerRef.current.focus();
    }
  }, [expanded, highlighted]);
  const onClick = (event) => {
    var _a;
    if (!disabled) {
      event.preventDefault();
      onGroupToggle(item, event);
      (_a = triggerRef.current) === null || _a === void 0 ? void 0 : _a.focus();
    }
  };
  const onHover = (event) => {
    event.preventDefault();
    highlightItem(item);
  };
  const isDisabledWithReason = !!item.disabledReason && item.disabled;
  const { targetProps, descriptionEl } = useHiddenDescription(item.disabledReason);
  const trigger = item.text && import_react5.default.createElement(
    "span",
    Object.assign({
      className: clsx_m_default(styles_css_default4.header, styles_css_default4["expandable-header"], styles_css_default4[`variant-${variant}`], {
        [styles_css_default4.disabled]: disabled,
        [styles_css_default4.highlighted]: highlighted,
        [styles_css_default4["is-focused"]]: isKeyboardHighlighted
      }),
      tabIndex: highlighted ? 0 : -1,
      ref: triggerRef
    }, getMenuItemProps({ parent: true, expanded, disabled }), isDisabledWithReason ? targetProps : {}),
    item.text,
    import_react5.default.createElement(
      "span",
      { className: clsx_m_default(styles_css_default4["expand-icon"], styles_css_default4["expand-icon-right"]) },
      import_react5.default.createElement(internal_default, { name: "caret-down-filled" })
    )
  );
  let content;
  if (isDisabledWithReason) {
    content = import_react5.default.createElement(
      Tooltip,
      { content: item.disabledReason },
      trigger,
      descriptionEl
    );
  } else if (disabled) {
    content = trigger;
  } else {
    content = import_react5.default.createElement(dropdown_default, { open: expanded, stretchWidth: false, interior: true, expandToViewport, trigger }, item.items && expanded && import_react5.default.createElement(
      "ul",
      { role: "menu", "aria-label": item.text, className: clsx_m_default(styles_css_default4["items-list-container"]) },
      import_react5.default.createElement(ItemsList, { items: item.items, onItemActivate, onGroupToggle, targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, variant })
    ));
  }
  return import_react5.default.createElement("li", { className: clsx_m_default(styles_css_default4.category, styles_css_default4[`variant-${variant}`], styles_css_default4.expandable, {
    [styles_css_default4.expanded]: expanded,
    [styles_css_default4.disabled]: disabled,
    [styles_css_default4.highlighted]: highlighted
  }), role: "presentation", "data-testid": item.id, ref, onClick, onMouseEnter: onHover, onTouchStart: onHover }, content);
};
var expandable_category_element_default = ExpandableCategoryElement;

// node_modules/@cloudscape-design/components/button-dropdown/category-elements/category-element.js
var import_react6 = __toESM(require_react());
var CategoryElement = ({ item, onItemActivate, onGroupToggle, targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, disabled, variant }) => {
  return import_react6.default.createElement(
    "li",
    { className: clsx_m_default(styles_css_default4.category, styles_css_default4[`variant-${variant}`], disabled && styles_css_default4.disabled), role: "presentation", "aria-disabled": disabled ? "true" : void 0 },
    item.text && import_react6.default.createElement("p", { className: clsx_m_default(styles_css_default4.header, { [styles_css_default4.disabled]: disabled }), "aria-hidden": "true" }, item.text),
    import_react6.default.createElement("ul", { className: clsx_m_default(styles_css_default4["items-list-container"]), role: "group", "aria-label": item.text }, item.items && import_react6.default.createElement(ItemsList, { items: item.items, onItemActivate, onGroupToggle, targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, categoryDisabled: disabled, hasCategoryHeader: !!item.text, variant }))
  );
};
var category_element_default = CategoryElement;

// node_modules/@cloudscape-design/components/button-dropdown/category-elements/mobile-expandable-category-element.js
var import_react8 = __toESM(require_react());

// node_modules/@cloudscape-design/components/button-dropdown/mobile-expandable-group/mobile-expandable-group.js
var import_react7 = __toESM(require_react());

// node_modules/@cloudscape-design/components/button-dropdown/mobile-expandable-group/styles.css.js
import "/local/home/samilafo/final_epa_project/cloudscape_wrkshp/cloudscape-design-system-workshop/node_modules/@cloudscape-design/components/button-dropdown/mobile-expandable-group/styles.scoped.css";
var styles_css_default5 = {
  "root": "awsui_root_14cnr_c6muv_93",
  "trigger": "awsui_trigger_14cnr_c6muv_108",
  "dropdown": "awsui_dropdown_14cnr_c6muv_111",
  "nowrap": "awsui_nowrap_14cnr_c6muv_122",
  "open": "awsui_open_14cnr_c6muv_125"
};

// node_modules/@cloudscape-design/components/button-dropdown/mobile-expandable-group/mobile-expandable-group.js
var MobileExpandableGroup = ({ children, trigger, open }) => {
  return import_react7.default.createElement(
    "div",
    { className: clsx_m_default(styles_css_default5.root) },
    import_react7.default.createElement("div", { className: styles_css_default5.trigger }, trigger),
    import_react7.default.createElement("div", { className: clsx_m_default(styles_css_default5.dropdown, { [styles_css_default5.open]: open }), "data-open": open }, children)
  );
};
var mobile_expandable_group_default = MobileExpandableGroup;

// node_modules/@cloudscape-design/components/button-dropdown/category-elements/mobile-expandable-category-element.js
var MobileExpandableCategoryElement = ({ item, onItemActivate, onGroupToggle, targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, disabled, variant }) => {
  const highlighted = isHighlighted(item);
  const expanded = isExpanded(item);
  const isKeyboardHighlighted = isKeyboardHighlight(item);
  const triggerRef = import_react8.default.useRef(null);
  (0, import_react8.useEffect)(() => {
    if (triggerRef.current && highlighted && !expanded) {
      triggerRef.current.focus();
    }
  }, [expanded, highlighted]);
  const onClick = (e) => {
    if (!disabled) {
      e.preventDefault();
      onGroupToggle(item, e);
    }
  };
  const onHover = (event) => {
    event.preventDefault();
    highlightItem(item);
  };
  const isDisabledWithReason = !!item.disabledReason && item.disabled;
  const { targetProps, descriptionEl } = useHiddenDescription(item.disabledReason);
  const trigger = item.text && import_react8.default.createElement(
    "span",
    Object.assign({
      className: clsx_m_default(styles_css_default4.header, styles_css_default4["expandable-header"], styles_css_default4[`variant-${variant}`], {
        [styles_css_default4.highlighted]: highlighted,
        [styles_css_default4["rolled-down"]]: expanded,
        [styles_css_default4.disabled]: disabled,
        [styles_css_default4["is-focused"]]: isKeyboardHighlighted
      }),
      tabIndex: highlighted ? 0 : -1,
      ref: triggerRef
    }, getMenuItemProps({ parent: true, disabled, expanded }), isDisabledWithReason ? targetProps : {}),
    item.text,
    import_react8.default.createElement(
      "span",
      { className: clsx_m_default(styles_css_default4["expand-icon"], {
        [styles_css_default4["expand-icon-up"]]: expanded
      }) },
      import_react8.default.createElement(internal_default, { name: "caret-down-filled" })
    )
  );
  let content;
  if (isDisabledWithReason) {
    content = import_react8.default.createElement(
      import_react8.default.Fragment,
      null,
      descriptionEl,
      import_react8.default.createElement(Tooltip, { content: item.disabledReason }, trigger)
    );
  } else if (disabled) {
    content = trigger;
  } else {
    content = import_react8.default.createElement(mobile_expandable_group_default, { open: expanded, trigger }, item.items && expanded && import_react8.default.createElement(
      "ul",
      { role: "menu", "aria-label": item.text, className: clsx_m_default(styles_css_default4["items-list-container"]) },
      import_react8.default.createElement(ItemsList, { items: item.items, onItemActivate, onGroupToggle, targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, hasCategoryHeader: true, variant })
    ));
  }
  return import_react8.default.createElement("li", { className: clsx_m_default(styles_css_default4.category, styles_css_default4[`variant-${variant}`], styles_css_default4.expandable, {
    [styles_css_default4.expanded]: expanded,
    [styles_css_default4.disabled]: disabled,
    [styles_css_default4.highlighted]: highlighted || expanded,
    [styles_css_default4.expandable]: true
  }), role: "presentation", onClick, onMouseEnter: onHover, onTouchStart: onHover, "data-testid": item.id }, content);
};
var mobile_expandable_category_element_default = MobileExpandableCategoryElement;

// node_modules/@cloudscape-design/components/button-dropdown/items-list.js
function ItemsList({ items, onItemActivate, onGroupToggle, targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, categoryDisabled = false, hasExpandableGroups = false, hasCategoryHeader = false, expandToViewport = false, variant = "normal" }) {
  const isMobile = useMobile();
  const elements = items.map((item, index) => {
    var _a, _b, _c, _d;
    if (!isItemGroup(item)) {
      return import_react9.default.createElement(item_element_default, { key: index, item, onItemActivate, disabled: (_a = item.disabled) !== null && _a !== void 0 ? _a : categoryDisabled, highlighted: isHighlighted(item), isKeyboardHighlighted: isKeyboardHighlight(item), highlightItem, first: index === 0 || isItemGroup(items[index - 1]), last: index === items.length - 1 || isItemGroup(items[index + 1]), hasCategoryHeader, variant });
    }
    if (hasExpandableGroups) {
      return item.text ? isMobile ? import_react9.default.createElement(mobile_expandable_category_element_default, { key: index, item, onItemActivate, onGroupToggle, targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, disabled: (_b = item.disabled) !== null && _b !== void 0 ? _b : false, variant }) : import_react9.default.createElement(expandable_category_element_default, { key: index, item, onItemActivate, onGroupToggle, targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, disabled: (_c = item.disabled) !== null && _c !== void 0 ? _c : false, expandToViewport, variant }) : null;
    }
    return import_react9.default.createElement(category_element_default, { key: index, item, onItemActivate, onGroupToggle, targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, disabled: (_d = item.disabled) !== null && _d !== void 0 ? _d : false, variant });
  });
  return import_react9.default.createElement(import_react9.default.Fragment, null, elements);
}

// node_modules/@cloudscape-design/components/button-dropdown/utils/use-highlighted-menu.js
var import_react10 = __toESM(require_react());

// node_modules/@cloudscape-design/components/button-dropdown/utils/create-items-tree.js
function createItemsTree(items) {
  const itemToIndex = /* @__PURE__ */ new Map();
  const indexToItem = /* @__PURE__ */ new Map();
  const flatIndices = [];
  traverseItems(items, (item, index) => {
    const indexKey = stringifyIndex(index);
    itemToIndex.set(item, indexKey);
    indexToItem.set(indexKey, item);
    flatIndices.push(indexKey);
  });
  return {
    getItem: (index) => {
      const indexKey = stringifyIndex(index);
      return indexToItem.get(indexKey) || null;
    },
    getItemIndex: (item) => {
      const indexKey = itemToIndex.get(item);
      if (!indexKey) {
        throw new Error("Invariant violation: item is not found.");
      }
      return parseIndex(indexKey);
    },
    getSequentialIndex: (index, direction) => {
      const indexKey = stringifyIndex(index);
      const position = flatIndices.indexOf(indexKey);
      const nextIndexKey = flatIndices[position + direction];
      if (!nextIndexKey) {
        return null;
      }
      return parseIndex(nextIndexKey);
    },
    getParentIndex: (item) => {
      const indexKey = itemToIndex.get(item);
      if (!indexKey) {
        throw new Error("Invariant violation: item is not found.");
      }
      const index = parseIndex(indexKey);
      if (index.length === 1) {
        return null;
      }
      return index.slice(0, index.length - 1);
    }
  };
}
function traverseItems(items, act, parentIndex = []) {
  items.forEach((item, index) => {
    const itemIndex = [...parentIndex, index];
    act(item, itemIndex);
    if (isItemGroup(item)) {
      traverseItems(item.items, act, itemIndex);
    }
  });
}
function stringifyIndex(index) {
  return index.join("-");
}
function parseIndex(index) {
  return index.split("-").map((it) => parseInt(it));
}

// node_modules/@cloudscape-design/components/button-dropdown/utils/move-highlight.js
function moveHighlight({ startIndex, expandedIndex, getNext, hasExpandableGroups, isInRestrictedView }) {
  const tryMove = (currentIndex) => {
    var _a;
    const next = getNext(currentIndex);
    if (!next) {
      return null;
    }
    if (((_a = next.parent) === null || _a === void 0 ? void 0 : _a.disabled) && hasExpandableGroups) {
      return tryMove(next.index);
    }
    if (isItemGroup(next.item) && !hasExpandableGroups) {
      return tryMove(next.index);
    }
    if (hasExpandableGroups && !isInRestrictedView && !isSameParent(startIndex, next.index)) {
      return tryMove(next.index);
    }
    if (hasExpandableGroups && isInRestrictedView && !isSameLevel(next.index, expandedIndex) && !isIncluded(expandedIndex, next.index)) {
      return tryMove(next.index);
    }
    return next.index;
  };
  return tryMove(startIndex);
}
function isSameParent(left, right) {
  return indexEquals(left.slice(0, -1), right.slice(0, -1));
}
function isSameLevel(left, right) {
  return left.length === right.length;
}
function isIncluded(parent, child) {
  return indexEquals(parent, child.slice(0, -1));
}

// node_modules/@cloudscape-design/components/button-dropdown/utils/use-highlighted-menu.js
function useHighlightedMenu({ items, hasExpandableGroups, isInRestrictedView = false }) {
  const [targetIndex, setTargetIndex] = (0, import_react10.useState)([]);
  const [expandedIndex, setExpandedIndex] = (0, import_react10.useState)([]);
  const [isUsingMouse, setIsUsingMouse] = (0, import_react10.useState)(true);
  const { getItem, getItemIndex, getSequentialIndex, getParentIndex } = (0, import_react10.useMemo)(() => createItemsTree(items), [items]);
  const targetItem = (0, import_react10.useMemo)(() => getItem(targetIndex), [targetIndex, getItem]);
  const isHighlighted = (0, import_react10.useCallback)((item) => {
    const index = getItemIndex(item);
    return indexIncludes(index, targetIndex);
  }, [targetIndex, getItemIndex]);
  const isKeyboardHighlight = (0, import_react10.useCallback)((item) => {
    const index = getItemIndex(item);
    return !isUsingMouse && indexEquals(index, targetIndex);
  }, [targetIndex, getItemIndex, isUsingMouse]);
  const isExpanded = (0, import_react10.useCallback)((group) => {
    const index = getItemIndex(group);
    return indexIncludes(index, expandedIndex);
  }, [expandedIndex, getItemIndex]);
  const moveHighlight2 = (0, import_react10.useCallback)((direction) => {
    const getNext = (index) => {
      const nextIndex2 = getSequentialIndex(index, direction);
      const item = getItem(nextIndex2 || [-1]);
      if (!nextIndex2 || !item) {
        return null;
      }
      const parentIndex = getParentIndex(item);
      const parentItem = parentIndex && getItem(parentIndex);
      return { index: nextIndex2, item, parent: parentItem || void 0 };
    };
    const nextIndex = moveHighlight({
      startIndex: targetIndex,
      expandedIndex,
      getNext,
      hasExpandableGroups,
      isInRestrictedView
    });
    if (nextIndex) {
      setTargetIndex(nextIndex);
    }
  }, [targetIndex, expandedIndex, getItem, getSequentialIndex, getParentIndex, hasExpandableGroups, isInRestrictedView]);
  const highlightItem = (0, import_react10.useCallback)((item) => {
    setTargetIndex(getItemIndex(item));
  }, [getItemIndex]);
  const expandGroup = (0, import_react10.useCallback)((group) => {
    const groupIndex = group ? getItemIndex(group) : targetIndex;
    const firstChildIndex = [...groupIndex, 0];
    setTargetIndex(isInRestrictedView ? groupIndex : firstChildIndex);
    setExpandedIndex(groupIndex);
  }, [targetIndex, getItemIndex, isInRestrictedView]);
  const collapseGroup = (0, import_react10.useCallback)(() => {
    if (expandedIndex.length > 0) {
      setTargetIndex(expandedIndex);
      setExpandedIndex(expandedIndex.slice(0, -1));
    }
  }, [expandedIndex]);
  const reset = (0, import_react10.useCallback)(() => {
    setTargetIndex([]);
    setExpandedIndex([]);
  }, []);
  return {
    targetItem,
    isHighlighted,
    isKeyboardHighlight,
    isExpanded,
    moveHighlight: moveHighlight2,
    highlightItem,
    expandGroup,
    collapseGroup,
    reset,
    setIsUsingMouse
  };
}

// node_modules/@cloudscape-design/components/button-dropdown/utils/use-button-dropdown.js
function useButtonDropdown({ items, onItemClick, onItemFollow, onReturnFocus, hasExpandableGroups, isInRestrictedView = false, expandToViewport = false }) {
  const { targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, moveHighlight: moveHighlight2, expandGroup, collapseGroup, reset, setIsUsingMouse } = useHighlightedMenu({
    items,
    hasExpandableGroups,
    isInRestrictedView
  });
  const _a = useOpenState({ onClose: reset }), { isOpen, closeDropdown } = _a, openStateProps = __rest(_a, ["isOpen", "closeDropdown"]);
  const toggleDropdown = (options = {}) => {
    var _a2;
    const moveHighlightOnOpen = (_a2 = options.moveHighlightOnOpen) !== null && _a2 !== void 0 ? _a2 : true;
    if (!isOpen && moveHighlightOnOpen) {
      moveHighlight2(1);
    }
    openStateProps.toggleDropdown();
  };
  const onGroupToggle = (item) => !isExpanded(item) ? expandGroup(item) : collapseGroup();
  const onItemActivate = (item, event) => {
    const details = {
      id: item.id || "undefined",
      href: item.href,
      external: item.external,
      target: getItemTarget(item)
    };
    if (onItemFollow && item.href && isPlainLeftClick(event)) {
      fireCancelableEvent(onItemFollow, details, event);
    }
    if (onItemClick) {
      fireCancelableEvent(onItemClick, details, event);
    }
    onReturnFocus();
    closeDropdown();
  };
  const doVerticalNavigation = (direction) => {
    if (isOpen) {
      moveHighlight2(direction);
    }
  };
  const openAndSelectFirst = (event) => {
    toggleDropdown();
    event.preventDefault();
  };
  const actOnParentDropdown = (event) => {
    if (!targetItem) {
      if (isOpen && !isInRestrictedView) {
        toggleDropdown();
      } else {
        openAndSelectFirst(event);
      }
    } else {
      if (isItemGroup(targetItem)) {
        onGroupToggle(targetItem, event);
      } else {
        onItemActivate(targetItem, event);
      }
    }
  };
  const activate = (event, isEnter) => {
    setIsUsingMouse(false);
    if (targetItem && isLinkItem(targetItem) && isEnter) {
      return;
    }
    event.preventDefault();
    actOnParentDropdown(event);
  };
  const onKeyDown = (event) => {
    setIsUsingMouse(false);
    switch (event.keyCode) {
      case KeyCode.down: {
        doVerticalNavigation(1);
        event.preventDefault();
        break;
      }
      case KeyCode.up: {
        doVerticalNavigation(-1);
        event.preventDefault();
        break;
      }
      case KeyCode.space: {
        event.preventDefault();
        break;
      }
      case KeyCode.enter: {
        if (!(targetItem === null || targetItem === void 0 ? void 0 : targetItem.disabled)) {
          activate(event, true);
        }
        break;
      }
      case KeyCode.left:
      case KeyCode.right: {
        if (targetItem && !targetItem.disabled && isItemGroup(targetItem) && !isExpanded(targetItem)) {
          expandGroup();
        } else if (hasExpandableGroups) {
          collapseGroup();
        }
        event.preventDefault();
        break;
      }
      case KeyCode.escape: {
        onReturnFocus();
        closeDropdown();
        event.preventDefault();
        break;
      }
      case KeyCode.tab: {
        if (expandToViewport) {
          onReturnFocus();
        }
        closeDropdown();
        break;
      }
    }
  };
  const onKeyUp = (event) => {
    if (event.keyCode === KeyCode.space && !(targetItem === null || targetItem === void 0 ? void 0 : targetItem.disabled)) {
      activate(event);
    }
  };
  return {
    isOpen,
    targetItem,
    isHighlighted,
    isKeyboardHighlight,
    isExpanded,
    highlightItem,
    onKeyDown,
    onKeyUp,
    onItemActivate,
    onGroupToggle,
    toggleDropdown,
    setIsUsingMouse
  };
}

// node_modules/@cloudscape-design/components/button-dropdown/internal.js
var InternalButtonDropdown = import_react11.default.forwardRef((_a, ref) => {
  var { items, variant = "normal", loading = false, loadingText, disabled = false, expandableGroups = false, children, onItemClick, onItemFollow, customTriggerBuilder, expandToViewport, ariaLabel, title, description, preferCenter, __internalRootRef } = _a, props = __rest(_a, ["items", "variant", "loading", "loadingText", "disabled", "expandableGroups", "children", "onItemClick", "onItemFollow", "customTriggerBuilder", "expandToViewport", "ariaLabel", "title", "description", "preferCenter", "__internalRootRef"]);
  const isInRestrictedView = useMobile();
  const dropdownId = useUniqueId("dropdown");
  for (const item of items) {
    checkSafeUrl("ButtonDropdown", item.href);
  }
  const { isOpen, targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, onKeyDown, onKeyUp, onItemActivate, onGroupToggle, toggleDropdown, setIsUsingMouse } = useButtonDropdown({
    items,
    onItemClick,
    onItemFollow,
    onReturnFocus: () => {
      var _a2;
      return (_a2 = dropdownRef.current) === null || _a2 === void 0 ? void 0 : _a2.focus();
    },
    expandToViewport,
    hasExpandableGroups: expandableGroups,
    isInRestrictedView
  });
  const handleMouseEvent = () => {
    setIsUsingMouse(true);
  };
  const baseProps = getBaseProps(props);
  const dropdownRef = (0, import_react11.useRef)(null);
  useForwardFocus(ref, dropdownRef);
  const clickHandler = () => {
    if (!loading && !disabled) {
      toggleDropdown({ moveHighlightOnOpen: !isInRestrictedView });
    }
  };
  const canBeOpened = !loading && !disabled;
  const triggerVariant = variant === "navigation" ? void 0 : variant === "inline-icon" ? "inline-icon" : variant;
  const iconProps = variant === "icon" || variant === "inline-icon" ? {
    iconName: "ellipsis"
  } : {
    iconName: "caret-down-filled",
    iconAlign: "right",
    __iconClass: canBeOpened && isOpen ? styles_css_default2["rotate-up"] : styles_css_default2["rotate-down"]
  };
  const trigger = customTriggerBuilder ? customTriggerBuilder(clickHandler, dropdownRef, disabled, isOpen, ariaLabel) : import_react11.default.createElement(InternalButton, Object.assign({ ref: dropdownRef }, iconProps, { variant: triggerVariant, loading, loadingText, disabled, onClick: (event) => {
    event.preventDefault();
    clickHandler();
  }, ariaLabel, "aria-haspopup": true, ariaExpanded: canBeOpened && isOpen, formAction: "none" }), children);
  const hasHeader = title || description;
  const headerId = useUniqueId("awsui-button-dropdown__header");
  const { loadingButtonCount } = useFunnel();
  (0, import_react11.useEffect)(() => {
    if (loading) {
      loadingButtonCount.current++;
      return () => {
        loadingButtonCount.current--;
      };
    }
  }, [loading, loadingButtonCount]);
  return import_react11.default.createElement(
    "div",
    Object.assign({}, baseProps, { onKeyDown, onKeyUp, onMouseDown: handleMouseEvent, onMouseMove: handleMouseEvent, className: clsx_m_default(styles_css_default2["button-dropdown"], styles_css_default2[`variant-${variant}`], baseProps.className), "aria-owns": expandToViewport && isOpen ? dropdownId : void 0, ref: __internalRootRef }),
    import_react11.default.createElement(
      dropdown_default,
      { open: canBeOpened && isOpen, stretchWidth: false, stretchTriggerHeight: variant === "navigation", expandToViewport, preferCenter, onDropdownClose: () => toggleDropdown(), trigger, dropdownId },
      hasHeader && import_react11.default.createElement(
        "div",
        { className: styles_css_default2.header, id: headerId },
        title && import_react11.default.createElement(
          "div",
          { className: styles_css_default2.title },
          import_react11.default.createElement(InternalBox, { fontSize: "heading-s", fontWeight: "bold", color: "inherit", tagOverride: "h2", margin: { vertical: "n", horizontal: "n" } }, title)
        ),
        description && import_react11.default.createElement(
          InternalBox,
          { fontSize: "body-s" },
          import_react11.default.createElement("span", { className: styles_css_default2.description }, description)
        )
      ),
      import_react11.default.createElement(
        options_list_default,
        { open: canBeOpened && isOpen, position: "static", role: "menu", decreaseTopMargin: true, ariaLabelledby: hasHeader ? headerId : void 0, statusType: "finished" },
        import_react11.default.createElement(ItemsList, { items, onItemActivate, onGroupToggle, hasExpandableGroups: expandableGroups, targetItem, isHighlighted, isKeyboardHighlight, isExpanded, highlightItem, expandToViewport, variant })
      )
    )
  );
});
var internal_default2 = InternalButtonDropdown;

export {
  styles_css_default2 as styles_css_default,
  arrow_default,
  internal_default2 as internal_default
};
//# sourceMappingURL=chunk-EW7GCZX3.js.map
