{
  "version": 3,
  "sources": ["../../@cloudscape-design/components/internal/components/focus-lock/internal/components/focus-lock/index.tsx"],
  "sourcesContent": ["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useCallback, useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport { useMergeRefs } from '../../hooks/use-merge-refs';\n\nimport TabTrap from '../tab-trap/index';\nimport { getFirstFocusable, getLastFocusable } from './utils';\n\nexport interface FocusLockProps {\n  className?: string;\n  disabled?: boolean;\n  autoFocus?: boolean;\n  restoreFocus?: boolean;\n  children: React.ReactNode;\n}\n\nexport interface FocusLockRef {\n  /**\n   * Focuses the first element in the component.\n   */\n  focusFirst(): void;\n}\n\nfunction FocusLock(\n  { className, disabled, autoFocus, restoreFocus, children }: FocusLockProps,\n  ref: React.Ref<FocusLockRef>\n) {\n  const returnFocusToRef = useRef<HTMLOrSVGElement | null>(null);\n  const containerRef = useRef<HTMLDivElement | null>(null);\n\n  const focusFirst = () => {\n    if (containerRef.current) {\n      getFirstFocusable(containerRef.current)?.focus();\n    }\n  };\n\n  const focusLast = () => {\n    if (containerRef.current) {\n      getLastFocusable(containerRef.current)?.focus();\n    }\n  };\n\n  // Captures focus when `autoFocus` is set, and the component is mounted or\n  // `disabled` changes from true to false.\n  useEffect(() => {\n    if (autoFocus && !disabled) {\n      returnFocusToRef.current = document.activeElement as HTMLOrSVGElement | null;\n      focusFirst();\n    }\n  }, [autoFocus, disabled]);\n\n  // Restore focus if `restoreFocus` is set, and `disabled` changes from false\n  // to true.\n  const [previouslyDisabled, setPreviouslyDisabled] = useState(!!disabled);\n  useEffect(() => {\n    if (previouslyDisabled !== !!disabled) {\n      setPreviouslyDisabled(!!disabled);\n      if (restoreFocus && disabled) {\n        returnFocusToRef.current?.focus();\n        returnFocusToRef.current = null;\n      }\n    }\n  }, [previouslyDisabled, disabled, restoreFocus]);\n\n  // Restore focus if `restoreFocus` is set and the component is unmounted.\n  // Using a callback ref for this is safer than using useEffect cleanups.\n  const restoreFocusHandler = useCallback(\n    (elem: HTMLDivElement | null) => {\n      if (elem === null && restoreFocus) {\n        returnFocusToRef.current?.focus();\n        returnFocusToRef.current = null;\n      }\n    },\n    [restoreFocus]\n  );\n\n  useImperativeHandle(ref, () => ({ focusFirst }));\n  const mergedRef = useMergeRefs(containerRef, restoreFocusHandler);\n\n  return (\n    <>\n      <TabTrap disabled={disabled} focusNextCallback={focusLast} />\n      <div className={className} ref={mergedRef}>\n        {children}\n      </div>\n      <TabTrap disabled={disabled} focusNextCallback={focusFirst} />\n    </>\n  );\n}\n\nexport default React.forwardRef(FocusLock);\n"],
  "mappings": ";;;;;;;;;;;;;;AAEA,mBAAqF;AAqBrF,SAAS,UACP,EAAE,WAAW,UAAU,WAAW,cAAc,SAAQ,GACxD,KAA4B;AAE5B,QAAM,uBAAmB,qBAAgC,IAAI;AAC7D,QAAM,mBAAe,qBAA8B,IAAI;AAEvD,QAAM,aAAa,MAAK;;AACtB,QAAI,aAAa,SAAS;AACxB,OAAA,KAAA,kBAAkB,aAAa,OAAO,OAAC,QAAA,OAAA,SAAA,SAAA,GAAE,MAAK;;EAElD;AAEA,QAAM,YAAY,MAAK;;AACrB,QAAI,aAAa,SAAS;AACxB,OAAA,KAAA,iBAAiB,aAAa,OAAO,OAAC,QAAA,OAAA,SAAA,SAAA,GAAE,MAAK;;EAEjD;AAIA,8BAAU,MAAK;AACb,QAAI,aAAa,CAAC,UAAU;AAC1B,uBAAiB,UAAU,SAAS;AACpC,iBAAU;;EAEd,GAAG,CAAC,WAAW,QAAQ,CAAC;AAIxB,QAAM,CAAC,oBAAoB,qBAAqB,QAAI,uBAAS,CAAC,CAAC,QAAQ;AACvE,8BAAU,MAAK;;AACb,QAAI,uBAAuB,CAAC,CAAC,UAAU;AACrC,4BAAsB,CAAC,CAAC,QAAQ;AAChC,UAAI,gBAAgB,UAAU;AAC5B,SAAA,KAAA,iBAAiB,aAAO,QAAA,OAAA,SAAA,SAAA,GAAE,MAAK;AAC/B,yBAAiB,UAAU;;;EAGjC,GAAG,CAAC,oBAAoB,UAAU,YAAY,CAAC;AAI/C,QAAM,0BAAsB,0BAC1B,CAAC,SAA+B;;AAC9B,QAAI,SAAS,QAAQ,cAAc;AACjC,OAAA,KAAA,iBAAiB,aAAO,QAAA,OAAA,SAAA,SAAA,GAAE,MAAK;AAC/B,uBAAiB,UAAU;;EAE/B,GACA,CAAC,YAAY,CAAC;AAGhB,wCAAoB,KAAK,OAAO,EAAE,WAAU,EAAG;AAC/C,QAAM,YAAY,aAAa,cAAc,mBAAmB;AAEhE,SACE,aAAAA,QAAA;IAAA,aAAAA,QAAA;IAAA;IACE,aAAAA,QAAA,cAAC,SAAO,EAAC,UAAoB,mBAAmB,UAAS,CAAA;IACzD,aAAAA,QAAA,cAAA,OAAA,EAAK,WAAsB,KAAK,UAAS,GACtC,QAAQ;IAEX,aAAAA,QAAA,cAAC,SAAO,EAAC,UAAoB,mBAAmB,WAAU,CAAA;EAAI;AAGpE;AAEA,IAAA,qBAAe,aAAAA,QAAM,WAAW,SAAS;",
  "names": ["React"]
}
